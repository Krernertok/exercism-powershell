name: pre-merge-tests

on:
    pull_request: 
        types: ["opened", "reopened", "edited"]
    workflow_dispatch:

jobs:
    pull_request_tests:
        runs-on: ubuntu-latest
        defaults:
            run:
                shell: pwsh

        steps:
            - name: Install Pester
              run: Install-Module -Name Pester -Force -SkipPublisherCheck

            - name: Change directory
              run: Write-Output $GITHUB_BASE_REF >> $Env:GITHUB_OUTPUT

            - name: Run tests
              run: Invoke-Pester
